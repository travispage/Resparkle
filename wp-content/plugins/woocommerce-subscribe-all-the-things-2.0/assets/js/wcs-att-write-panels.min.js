jQuery(function(a){function b(){var b=a("select#product-type").val(),c=f.find(".subscription_scheme").length;"subscription"!==b&&"variable-subscription"!==b&&(c>0?a(".subscription_one_time_shipping").show():a(".subscription_one_time_shipping").hide())}function c(){f.find(".subscription_scheme").each(function(b,c){a(".position",c).val(parseInt(a(c).index(".subscription_schemes .subscription_scheme")))})}function d(){var b=f.find(".subscription_scheme").get();b.sort(function(b,c){var d=parseInt(a(b).attr("rel")),e=parseInt(a(c).attr("rel"));return d<e?-1:d>e?1:0}),a(b).each(function(a,b){f.append(b)}),f.sortable({items:".subscription_scheme",cursor:"move",axis:"y",handle:"span.scheme-handle",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,b){b.item.removeAttr("style"),c()}})}var e=a("#wcsatt_data"),f=e.find(".subscription_schemes"),g={message:null,overlayCSS:{background:""!==wcsatt_admin_params.post_id?"#fff":"#f1f1f1",opacity:.6}};a.fn.wcsatt_scripts=function(){a(this).find(".help_tip, .tips, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},a.fn.wcsatt_refresh_scheme_lengths=function(){var b=a(this).find(".wc_input_subscription_length"),c=a(this).find(".wc_input_subscription_period"),d=a(this).find(".wc_input_subscription_period_interval"),e=b.val(),f=parseInt(d.val()),g=!1;b.empty(),a.each(wcsatt_admin_params.subscription_lengths[c.val()],function(c,d){0!=parseInt(c)&&0!=parseInt(c)%f||b.append(a("<option></option>").attr("value",c).text(d))}),b.children("option").each(function(){if(this.value==e)return g=!0,!1}),g?b.val(e):b.val(0)},""===wcsatt_admin_params.post_id&&(e.on("click","h3",function(){var b=a(this).closest(".wc-metabox"),c=b.find(".wc-metabox-content");b.hasClass("closed")?c.show():c.hide(),b.toggleClass("closed")}),e.find(".wc-metabox").each(function(){var b=a(this),c=b.find(".wc-metabox-content");b.hasClass("closed")&&c.hide()})),e.on("woocommerce_subscription_schemes_changed",function(){b()}),a("select#product-type").change(function(){b()}).change(),f.on("change","select.subscription_pricing_method_input",function(){var b=a(this).val();a(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method").hide(),a(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method_"+b).show()}),f.find("select.subscription_pricing_method_input").change(),e.find("input#_wcsatt_force_subscription").on("change",function(){a(this).is(":checked")?e.find(".wcsatt_default_status").hide():e.find(".wcsatt_default_status").show()}).change(),f.on("change",".wc_input_subscription_period",function(){a(this).closest(".subscription_scheme").wcsatt_refresh_scheme_lengths()}),e.on("click","a.remove_row",function(){var b=a(this).closest(".subscription_scheme");return b.find("*").off(),b.remove(),c(),e.trigger("woocommerce_subscription_schemes_changed"),!1}),e.on("click",".expand_all",function(){return f.find(".wc-metabox > .wc-metabox-content").show(),!1}),e.on("click",".close_all",function(){return f.find(".wc-metabox > .wc-metabox-content").hide(),!1});var h=e.find(".wc-metabox").length;e.on("click","button.add_subscription_scheme",function(){e.block(g),h++;var b={action:"wcsatt_add_subscription_scheme",post_id:wcsatt_admin_params.post_id,index:h,security:wcsatt_admin_params.add_subscription_scheme_nonce};return a.post(wcsatt_admin_params.wc_ajax_url,b,function(b){f.append(b.markup);var d=f.find(".subscription_scheme").last();d.wcsatt_scripts(),a("input#_virtual").change(),d.find("select.subscription_pricing_method_input").change(),c(),e.unblock(),e.trigger("woocommerce_subscription_scheme_added",b),e.trigger("woocommerce_subscription_schemes_changed")},"json"),!1}),d()});